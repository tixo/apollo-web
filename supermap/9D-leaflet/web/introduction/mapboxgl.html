<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>iClient for MapboxGL 产品介绍</title>
    <link rel="shortcut icon" type="image/x-icon" href="../img/favicon.ico"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <script type="text/javascript" include='mapboxgl,iclient9-mapboxgl,g6,isIntroduction' src="../js/include.js"></script>
</head>
<body class="hold-transition skin-blue">

<!--顶部导航-->
<header class="header-wrapper main-header icl-header"></header>
<script>
    var identification = {
        name: "MapboxGL"
    };
    var navigation = {
        nav: {
            title: "SuperMap iClient 9D",
            version: "",
            path: "../"
        }
    };
    utils.loadTemplate(".icl-header", "../template/header.html", navigation);
</script>
<!--顶部导航 end-->

<!--内容区-->
<div class="container icl-docs-container">

    <div class="row">
        <!--左侧导航-->
        <div class="col-md-3" role="complementary">
            <nav class="icl-docs-sidebar hidden-print hidden-xs hidden-sm affix-top">
                <ul class="nav icl-docs-sidenav">
                    <li><a href="#introduce">产品介绍</a>

                    </li>
                    <li><a href="#download">下载</a>

                    </li>

                    <li><a href="#guide">开发指南</a>
                        <ul class="nav">
                            <li><a href="#entry">快速入门</a></li>
                        </ul>
                    </li>
                    <li><a href="#modules">模块说明</a>

                    </li>
                    <li><a href="#dependence">相关依赖</a>

                    </li>
                    <li><a href="#license">许可说明</a>

                    </li>
                </ul>
                <a class="back-to-top" href="#top">
                    返回顶部
                </a>
            </nav>
        </div>
        <!--右侧内容区-->
        <div class="col-md-9" id="main-content" role="main">
            <div class="icl-docs-header">
                <h1 class="product">SuperMap iClient for MapboxGL</h1>
            </div>
            <div class="section icl-docs-section">
                <h2 id="introduce" class="section-title">产品介绍</h2>
                <p class="lead">SuperMap iClient for MapboxGL 是一套基于MapboxGL的云GIS网络客户端开发平台，
                    支持访问SuperMap iServer / iExpress / iPortal / iManager / Online的地图、服务和资源，为用户提供了完整专业的GIS能力，
                    同时提供了优秀的可视化功能。
                </p>
                <p class="lead">GitHub托管地址：<a href="https://github.com/SuperMap/iClient-JavaScript/tree/master/src/mapboxgl"
                                              target="_blank">https://github.com/SuperMap/iClient-JavaScript/tree/master/src/mapboxgl</a>
                </p>
                <p class="lead">OSChina托管地址：<a href="https://gitee.com/isupermap/iClient9/tree/master/src/mapboxgl"
                                               target="_blank">https://gitee.com/isupermap/iClient9/tree/master/src/mapboxgl</a>
                </p>
            </div>

            <div class="section icl-docs-section">
                <h2 id="download" class="section-title">下载</h2>
                <div style="text-align:center;margin:0 auto;margin-top: 30px">
                    <a target="_blank"
                       href="../download/Download.html"
                       class="btn btn-outline-inverse btn-lg">进入下载页</a>
                </div>
            </div>

            <div class="section icl-docs-section">
                <h2 id="guide" class="section-title">开发指南</h2>
                <p class="lead"></p>
                <div class="section section-level-1">
                    <h3 id="entry" class="section-title">快速入门</h3>
                    <p class="lead">本章节主要介绍SuperMap iClient for MapboxGL的入门用法，接口的详细参数请参考API页面。</p>
                    <div class="section section-level-1">
                        <p>引入 mapbox-gl.js 或 mapbox-gl-dev.js，MapBoxGL此处引入的BootCDN的托管地址：</p>
                        <figure class="highlight">
                            <pre class="javascript"><code class="html">&lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.bootcss.com/mapbox-gl/0.39.1/mapbox-gl.js&quot;&gt;&lt;/script&gt;</code></pre>
                        </figure>
                        <p>引入 iclient9-mapboxgl.js 或 iclient9-mapboxgl.min.js：</p>
                        <figure class="highlight">
                            <pre class="javascript"><code class="html">&lt;script type=&quot;text/javascript&quot; src=&quot;http://iclient.supermap.io/dist/iclient9-mapboxgl.js&quot;&gt;&lt;/script&gt;</code></pre>
                        </figure>
                    </div>
                    <p>将 iServer 发布的地图加载至 MapboxGL 的 map 中：</p>
                    <figure class="highlight">
                    <pre class="javascript"><code>var map = new mapboxgl.Map(
{
   container: "map",
   style: {
     "sources": {
        "raster-tiles": {
          "type": "raster",
          "tiles": [
            'http://localhost:8090/iserver/services/map/rest/maps/China/zxyTileImage.png?z={z}&x={x}&y={y}'
          ],
        }
     },
     "layers": [{
        "id": "simple-tiles",
        "type": "raster",
        "source": "raster-tiles",
     }]
   },
});<a href="../../examples/mapboxgl/editor.html#01_tiledMapLayer"
      style="font-size: 10px;float:right">查看源码&nbsp;&raquo;</a></code>
                    </pre>
                    </figure>
                    <p>运行效果</p>
                    <div id="map" class="map"></div>
                </div>
            </div>
            <div class="section icl-docs-section">
                <h2 id="modules" class="section-title">模块说明</h2>
                <p class="lead"></p>
                <div class="highlight">
                    <div id="moduleIntro"></div>
                </div>
            </div>
            <div class="section icl-docs-section">
                <h2 id="dependence" class="section-title">相关依赖</h2>
                <!--相关依赖-->
                <div class="logos">
                    <div class="col-md-4 col-sm-4 bundle text-center bundle-region bundle-region-hl">
                        <div class="bundle-wrapper">
                            <a href="https://www.mapbox.com/" target="_blank">
                                <img style="height:40px" src="../img/lib/Mapbox.png">
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-4 bundle text-center bundle-region bundle-region-hl">
                        <div class="bundle-wrapper">
                            <a href="http://echarts.baidu.com/" target="_blank">
                                <img style="height:40px" src="../img/lib/ECharts.png">
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-4 bundle text-center bundle-region bundle-region-hl">
                        <div class="bundle-wrapper">
                            <a href="http://mapv.baidu.com/" target="_blank">
                                <img style="height:50px" src="../img/lib/MapV.png">
                            </a>
                        </div>
                    </div>
                </div>
                <!--相关依赖end-->
            </div>
            <div class="section icl-docs-section">
                <h2 id="license" class="section-title">许可说明</h2>
                <a href="https://github.com/SuperMap/iClient-JavaScript/blob/master/LICENSE" target="_blank">
                    <p class="lead">Apache License 2.0</p>
                </a>
            </div>
        </div>
    </div>
</div>
<!--内容区 end-->

<!--footer-->
<footer class="icl-footer"></footer>
<script>
    utils.loadTemplate(".icl-footer", "../template/footer.html");
</script>
<!--footer end-->

<script type="text/javascript" src="../js/common.js"></script>
<script>
    /*Base Map*/
    var host = window.isLocal ? window.server : "http://support.supermap.com.cn:8090";
    var url = host + "/iserver/services/map-china400/rest/maps/China/zxyTileImage.png?z={z}&x={x}&y={y}";
    var mbAttribution = "<a href='https://www.mapbox.com/about/maps/' target='_blank'>© Mapbox </a>" +
            "| Map Data <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a> " +
            " with <a href='http://iclient.supermap.io' target='_blank'>SuperMap iClient</a>";

    var mbMap = new mapboxgl.Map({
        container: 'map',
        style: {
            "version": 8,
            "sources": {
                "raster-tiles": {
                    "attribution": mbAttribution,
                    "type": "raster",
                    "tiles": [url],
                }
            },
            "layers": [{
                "id": "simple-tiles",
                "type": "raster",
                "source": "raster-tiles",
                "minzoom": 1,
                "maxzoom": 15
            }]
        },
        center: [116.38, 39.89],
        zoom: 9.5,
        /*  interactive: false,*/
        attributionControl: false
    });
    mbMap.dragPan.enable();
    mbMap.addControl(new mapboxgl.AttributionControl({compact: true}));
    mbMap.addControl(new mapboxgl.NavigationControl(), 'top-left');
</script>
<script>
    var data = NodesConversionTool.depsToNodes("mapboxgl");

    var Util = G6.Util;
    // 准备布局配置
    var layoutCfg = {
        "direction": "LR",
        "nodeSep": 20,
        "nodeSize": 20,
        "rankSep": 200
    };
    // 自定义树节点
    var DEFAULT_NODE_SIZE = 5;
    G6.registNode('treeNode', {
        draw(cfg, group) {
            var origin = cfg.origin;
            var r = layoutCfg.nodeSize ? layoutCfg.nodeSize / 2 : DEFAULT_NODE_SIZE;
            var shapeCfg = {
                attrs: {
                    x: cfg.x,
                    y: cfg.y,
                    r: r,
                    stroke: '#003380',
                    fill: 'white',
                    fillOpacity: 1,
                },
            };
            if (origin.children && origin.children.length) {
                shapeCfg.class = origin.isCollapsed ? 'spreadoutButton' : 'collapseButton';
                shapeCfg.attrs.fill = '#044A9A';
                shapeCfg.attrs.stroke = '#003380';
                shapeCfg.attrs.fillOpacity = 0.4;
            }
            if (origin.root) {
                shapeCfg.attrs.fill = '#044A9A';
                shapeCfg.attrs.stroke = '#003380';
                shapeCfg.attrs.fillOpacity = 0.7;
            }
            shapeCfg.attrStash = Util.mix({}, shapeCfg.attrs);
            return group.addShape('circle', shapeCfg);
        },
        afterDraw(cfg, group) {
            var origin = cfg.origin;
            var r = layoutCfg.nodeSize ? layoutCfg.nodeSize / 2 : DEFAULT_NODE_SIZE;
            var align = origin.align;
            var labelAttrs = {
                text: origin.name,
                fill: '#666',
                textBaseline: 'middle',
                fontSize: 35,
                x: cfg.x + r + DEFAULT_NODE_SIZE,
                y: cfg.y,
                textAlign: 'left',
            };
            if (align === 'R') {
                Util.mix(labelAttrs, {
                    x: cfg.x - r - DEFAULT_NODE_SIZE,
                    y: cfg.y,
                    textAlign: 'right',
                });
            } else if (align === 'T' || align === 'CH') {
                Util.mix(labelAttrs, {
                    x: cfg.x,
                    y: cfg.y + r + DEFAULT_NODE_SIZE,
                    textAlign: 'right',
                    rotate: -Math.PI / 2,
                });
            } else if (align === 'B') {
                Util.mix(labelAttrs, {
                    x: cfg.x,
                    y: cfg.y - r - DEFAULT_NODE_SIZE,
                    textAlign: 'left',
                    rotate: -Math.PI / 2,
                });
            }
            var label = group.addShape('text', {
                attrs: labelAttrs,
            });
            return label;
        }
    });
    // 生成树图实例
    var tree = new G6.Tree({
        id: 'moduleIntro',                            // 容器ID
        height: 600,                         // 画布高
        fitView: 'autoZoom',                 // 自动缩放
        layoutFn: G6.Layout.LayeredTidyTree, // 布局类型
        layoutCfg: layoutCfg,                // 布局配置
        showButton: false,
    });
    // 加载数据
    tree.source(data);
    tree.node().shape('treeNode');
    tree.edge()
            .shape('smooth')
            .style({
                stroke: '#A9BCD3'
            });
    tree.tooltip(true);
    tree.tooltip({split: ''});
    tree.node().tooltip(function (obj) {
        return [
            [obj.des]
        ]
    });
    // 渲染树图
    tree.render();
    // 添加事件
    tree.on('itemclick', function (ev) {
        if (ev.shape.__cfg.type !== 'circle' && ev.shape.__cfg.type !== 'path' && !ev.item.get('model').children && ev.item.get('model').name) {
            window.open("http://" + window.location.host + "/docs/mapboxgl/" + ev.item.get('model').name + ".html");
        }
    });
    tree.on('mouseenter', function (ev) {
        if (ev.itemType === 'edge') {
            return;
        }
        var shape = ev.shape;
        if (shape.__cfg.type !== 'circle') {
            shape._setAttr("fill", "#3C8DBC");
            tree.refresh();
        }
    });
    tree.on('mousemove', function (ev) {
        $('#canvas_2').css('cursor', 'pointer');
    });
    tree.on('mouseleave', function (ev) {
        if (ev.itemType === 'edge') {
            return;
        }
        var shape = ev.shape;
        if (shape.__cfg.type !== 'circle') {
            shape._setAttr("fill", "#666");
            tree.refresh();
        }
    });
</script>
</body>
</html>